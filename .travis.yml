language: python
python:
  - '3.6'

env:
  global:
    - AWS_DEFAULT_REGION=ap-southeast-2

script:
  - make

deploy:
  provider: lambda
  publish: TRUE
  role: $ROLE_GET_GIGS
  function_name: "Get-Gigs"
  handler_name: "zootapi.lambda_handler"
  zip: dist/zootapi.zip
  environment:
    - RDS_INTANCE_IDENTIFIER=$RDS_INTANCE_IDENTIFIER
    - RDS_MASTER_USER=$RDS_MASTER_USER
    - RDS_MASTER_PASSWORD=$RDS_MASTER_PASSWORD
    - RDS_DATABASE_NAME=$RDS_DATABASE_NAME
    - RDS_ENDPOINT=$RDS_ENDPOINT
  on:
      branch: master